/* empty css             *//* empty css               */import{d as N,h as m,i as C,r as A,o as y,c as D,a as $,j as B,g as I,n as F,F as P,e as V,f as j,b as R,w as k,p as J,l as M}from"./index.ead62fed.js";const q=N({__name:"SlotItem",props:{name:null,id:null,picIndex:null,size:null,showCount:null,colorsList:null},emits:["moveEnd"],setup(v,{expose:h,emit:l}){var o;const n=v,a=m((o=n.picIndex)!=null?o:-1),c=m(n.id),u=m(),d=m(!1),i=m("start"),f=C(()=>{switch(i.value){case"start":return" ease-[cubic-bezier(.19,-1.04,.97,.68)]  duration-[500ms]";case"addSpeed":return" ease-linear  duration-[50ms]";case"loop":return" ease-linear  duration-[100ms]";case"slow":return" ease-linear  duration-[200ms]";case"end":return" ease-[cubic-bezier(.42,.48,.56,1.6)]  duration-[300ms]";case"none":default:return" "}}),r=C(()=>({"background-color":a.value===-1?"rgb(0,0,0,0)":n.colorsList[a.value]})),p=A({start:0,end:0}),g=C(()=>({width:`${n.size}px`,height:`${n.size}px`})),S=C(()=>({bottom:`${c.value*n.size}px`}));function x(){}async function b(){d.value=!1,c.value===-1&&(i.value="none",c.value=n.showCount,a.value=-1),l("moveEnd")}async function E(t,e){a.value=t.picId;const s=c.value,w=s===-1;c.value=t.id,u.value=t.endId,u.value===c.value?i.value="end":e?i.value=e:i.value="loop",p.start=(w?n.showCount:s)*n.size,p.end=c.value*n.size,d.value=!0}function z(){return{id:c.value,endId:u.value,picId:a.value,isMoving:d.value,name:n.name,type:i.value}}return h({setItemData:E,getItemData:z}),(t,e)=>(y(),D("div",{class:F(["absolute",[I(f)]]),style:B([I(g),I(S)]),onTransitionend:b,onTransitionstart:x},[$("div",{class:"w-full h-full rounded-full",style:B(I(r))},null,4)],38))}});function T(v=500){return new Promise(h=>{setTimeout(()=>{h("")},v)})}const G=N({__name:"SlotRow",props:{showCount:null,colorsList:null},setup(v,{expose:h}){const l=v,n=60,a=m([]),u={itemRefs:m([])},d=m(!1),i=m("loop"),f=C(()=>({width:`${n+2}px`,height:`${l.showCount*n+2}px`}));function r(){return Math.floor(Math.random()*l.colorsList.length)}function p(){u.itemRefs.value.sort((o,t)=>{const e=o.getItemData(),s=t.getItemData();return e.id<s.id?-1:1})}function g(){var e;const o=(e=a.value.pop())!=null?e:-1,t=o===-1?void 0:l.showCount-(a.value.length+1);return{picId:o,endId:t}}async function S(o){const t=u.itemRefs.value.find(s=>s.getItemData().name===o);if(!t)return;const e=t.getItemData();if(!d.value){const s=e.picId===-1?r():e.picId,w=e.type==="loop"&&i.value==="addSpeed"?"addSpeed":e.type,L=w==="start"||w==="none"?i.value:w,_=e.id-1;t.setItemData({id:_,picId:s},L)}}async function x(){for(p(),u.itemRefs.value.forEach(t=>{const e=t.getItemData(),s=e.picId===-1?r():e.picId;t.setItemData({id:e.id-1,picId:s},"start")});!d.value;)await T(20);p();const o=[];for(let t=0;t<l.showCount;t+=1)o.push(!1);for(;o.some(t=>t===!1);)u.itemRefs.value.forEach(t=>{const e=t.getItemData();if(!e.isMoving)if(e.id===e.endId)o[e.id]=!0;else{const s=e.id-1,{picId:w,endId:L}=e;if(w===-1){const _=g();t.setItemData({id:_.picId===-1?e.id:s,picId:_.picId===-1?r():_.picId,endId:_.endId},"slow")}else t.setItemData({id:s,picId:w,endId:L},"slow")}}),await T(50),p()}async function b(o=0){d.value=!1,i.value="loop",await T(o),await x()}function E(o){d.value=!0,a.value=o}function z(){i.value="addSpeed"}return h({spin:b,setRowData:E,addSpeed:z}),(o,t)=>(y(),D("div",{class:"border border-red-400 bg-slate-400 relative overflow-hidden",style:B(I(f))},[(y(!0),D(P,null,V(v.showCount+1,e=>(y(),j(q,{key:e,id:e-1,ref_for:!0,ref:u.itemRefs,name:e,size:n,picIndex:I(a)[I(a).length-1-(e-1)],showCount:v.showCount,colorsList:v.colorsList,onMoveEnd:s=>S(e)},null,8,["id","name","picIndex","showCount","colorsList","onMoveEnd"]))),128))],4))}}),H={class:"m-[100px]"},K={class:""},O={class:"flex items-center mt-4"},X=N({__name:"Slot",setup(v){const l={rowRefs:m([])},n=["red","black","blue","green","yellow"],a=[3,4,5,4,3],c=[[1,2,3],[1,2,3,4],[0,1,2,3,4],[1,2,3,4],[1,2,3]];async function u(){l.rowRefs.value.forEach((f,r)=>{f.spin(300*r)})}function d(){l.rowRefs.value.forEach(f=>{f.addSpeed()})}function i(){l.rowRefs.value.forEach((f,r)=>{setTimeout(()=>{f.setRowData([...c[r]])},500*r)})}return(f,r)=>{const p=J;return y(),D("div",H,[$("div",K,[R(p,{onClick:u},{default:k(()=>[M(" SPIN ")]),_:1}),R(p,{onClick:d},{default:k(()=>[M(" addSpeed ")]),_:1}),R(p,{onClick:i},{default:k(()=>[M(" stop ")]),_:1})]),$("div",O,[(y(),D(P,null,V(a,(g,S)=>R(G,{key:S,ref_for:!0,ref:l.rowRefs,showCount:g,colorsList:n},null,8,["showCount"])),64))])])}}});export{X as default};
